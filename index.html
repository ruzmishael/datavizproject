<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metro Manila Mass Transit Operations</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500&display=swap');

        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            font-family: 'Rubik', sans-serif;
            overflow: hidden; /* Ensure the photo covers the entire screen */
        }

        #landing-page {
            height: 100vh;
            background: url('703E7367-A835-4E0F-BC77-CA0426592E40.jpg') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Ensure the photo covers the entire screen */
        }

        .landing-content {
            background: rgba(255, 255, 255, 0);
            padding: 20px;
            width: 50%;
            text-align: right; /* Align the text to the right */
            color: white;
        }

        .start-now-btn {
            margin-top: 20px;
            color: grey;
        }

        .hide-element {
            display: none;
        }

        #map {
            flex: 1;
        }

        .map-overlay {
            position: absolute;
            bottom: 20px;
            left: 65%;
            transform: translateX(-50%);
            z-index: 1;
            background-color: transparent;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: none; /* Hide initially */
            /* Hide initially */
            justify-content: center;
        }

        /* Updated style for the text box */
        .text-box {
            position: absolute;
            top: 0;
            left: 0; /* Align the text box to the right side */
            width: 25%;
            height: 100%;
            background-color: rgba(242, 238, 222, 1);
            padding: 10px;
            overflow-y: auto;
            display: none; /* Hide initially */
        }

        .btn-line,
        .btn-line-all {
            margin: 0 5px;
            background-color: #ccc;
            border-radius: 10px;
            padding: 8px 16px;
            outline: none;
            box-shadow: none;
        }

        .btn-line-line1.active {
            background-color: green;
        }

        .btn-line-line2.active {
            background-color: purple;
        }

        .btn-line-line3.active {
            background-color: blue;
        }

        .btn-line-all.active {
            background-color: turquoise;
        }

    </style>
</head>

<body>

    <div id="landing-page">
        <div class="landing-content">
            <h1>Riles MNL</h1>
            <p>Your existing content...</p>
            <a href="#map" class="btn btn-primary start-now-btn" onclick="showMap()">Start now</a>
        </div>
    </div>

    <div id="map" class="hide-element"></div>

    <div class="map-overlay hide-element">
        <button type="button" class="btn btn-info btn-line btn-line-line1" onclick="toggleLine('line1')">LRT-1</button>
        <button type="button" class="btn btn-info btn-line btn-line-line2" onclick="toggleLine('line2')">LRT-2</button>
        <button type="button" class="btn btn-info btn-line btn-line-line3" onclick="toggleLine('line3')">MRT-3</button>
        <button type="button" class="btn btn-info btn-line btn-line-all" onclick="toggleAllLines()">All Lines</button>
    </div>

    <!-- New text box -->
    <div class="text-box hide-element">
    <div class="text-box">
        <h2>Riles MNL</h2>
        <p>Transportation in Metro Manila can be a complex and challenging issue, with various options available to commuters. Ride-hailing services are popular among those seeking comfort, while others rely on public transportation like the MRT and LRT. However, there is a lack of comprehensive and easily accessible information about the operations of these mass transit systems. This project aims to address this problem by providing a visually appealing overview of the MRT and LRT lines, including ridership data, capacity constraints, and maintenance information. By presenting this information in an interactive format, we hope to empower the public and stakeholders to make informed transportation choices and contribute to the improvement of the transportation system in Metro Manila.</p>
        <p>Thank you.</p>
    </div>

    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js' defer></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" defer></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" defer></script>

    <script>
        function showMap() {
            document.getElementById('landing-page').classList.add('hide-element');
            document.getElementById('map').classList.remove('hide-element');
            document.querySelector('.map-overlay').classList.remove('hide-element');
            document.querySelector('.text-box').classList.remove('hide-element');
        }

        window.onload = function () {
        }
        
        mapboxgl.accessToken = 'pk.eyJ1IjoicnV6bWlzaGFlbCIsImEiOiJjbG5yNjUzZTYwb3lmMmpwa200NndlNTNrIn0.DH2ARNo09iLGylY8SuiNwg';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/ruzmishael/clpcy5xx0003701pxdgz1fjp7',
            center: [120.95788, 14.58901],
            zoom: 11,
            minZoom: 11,
            maxZoom: 15,
            pitch: 0,
        });

        map.addControl(new mapboxgl.NavigationControl());

        var popup = new mapboxgl.Popup({
            closeButton: false,
            closeOnClick: false
        });

        map.on('load', function () {
            map.addSource('line1', {
                type: 'geojson',
                data: 'line1.geojson'
            });

            map.addSource('line2', {
                type: 'geojson',
                data: 'line2.geojson'
            });

            map.addSource('line3', {
                type: 'geojson',
                data: 'line3.geojson'
            });

            map.addLayer({
                id: 'line1',
                type: 'circle',
                source: 'line1',
                paint: {
                    'circle-radius': [
                        'interpolate',
                        ['linear'],
                        ['get', 'daily_ridership'],
                        0, 5,
                        100000, 20,
                    ],
                    'circle-color': '#ab4e52',
                    'circle-opacity': 0.5,
                },
                layout: {
                    'visibility': 'none'
                }
            });

            map.addLayer({
                id: 'line2',
                type: 'circle',
                source: 'line2',
                paint: {
                    'circle-radius': [
                        'interpolate',
                        ['linear'],
                        ['get', 'daily_ridership'],
                        0, 5,
                        100000, 20,
                    ],
                    'circle-color': '#ab4e52',
                    'circle-opacity': 0.5,
                },
                layout: {
                    'visibility': 'none'
                }
            });

            map.addLayer({
                id: 'line3',
                type: 'circle',
                source: 'line3',
                paint: {
                    'circle-radius': [
                        'interpolate',
                        ['linear'],
                        ['get', 'daily_ridership'],
                        0, 5,
                        100000, 20,
                    ],
                    'circle-color': '#ab4e52',
                    'circle-opacity': 0.5,
                },
                layout: {
                    'visibility': 'none'
                }
            });

            map.on('mouseenter', 'line1', function (e) {
                var stationName = e.features[0].properties.station_name;
                var dailyRidership = e.features[0].properties.daily_ridership;

                popup.setLngLat(e.lngLat)
                    .setHTML('<h5>' + stationName + '</h5><p>Daily Ridership: ' + dailyRidership + '</p>')
                    .addTo(map);
            });

            map.on('mouseleave', 'line1', function () {
                popup.remove();
            });

            map.on('mouseenter', 'line2', function (e) {
                var stationName = e.features[0].properties.station_name;
                var dailyRidership = e.features[0].properties.daily_ridership;

                popup.setLngLat(e.lngLat)
                    .setHTML('<h5>' + stationName + '</h5><p>Daily Ridership: ' + dailyRidership + '</p>')
                    .addTo(map);
            });

            map.on('mouseleave', 'line2', function () {
                popup.remove();
            });

            map.on('mouseenter', 'line3', function (e) {
                var stationName = e.features[0].properties.station_name;
                var dailyRidership = e.features[0].properties.daily_ridership;

                popup.setLngLat(e.lngLat)
                    .setHTML('<h5>' + stationName + '</h5><p>Daily Ridership: ' + dailyRidership + '</p>')
                    .addTo(map);
            });

            map.on('mouseleave', 'line3', function () {
                popup.remove();
            });

            map.on('mouseenter', 'line1', function () {
                map.getCanvas().style.cursor = 'pointer';
            });

            map.on('mouseenter', 'line2', function () {
                map.getCanvas().style.cursor = 'pointer';
            });

            map.on('mouseenter', 'line3', function () {
                map.getCanvas().style.cursor = 'pointer';
            });

            map.on('mouseleave', 'line1', function () {
                map.getCanvas().style.cursor = '';
            });

            map.on('mouseleave', 'line2', function () {
                map.getCanvas().style.cursor = '';
            });

            map.on('mouseleave', 'line3', function () {
                map.getCanvas().style.cursor = '';
            });

            // Show map overlay and text box after the map is loaded
            document.querySelector('.map-overlay').style.display = 'flex';
            document.querySelector('.text-box').style.display = 'block';
        });

        function showMap() {
            document.getElementById('landing-page').classList.add('hide-element');
            document.getElementById('map').classList.remove('hide-element');
            document.querySelector('.map-overlay').classList.remove('hide-element');
            document.querySelector('.text-box').classList.remove('hide-element');
        }
        }

        function updateTextBoxContent(lineId) {
            let content = '';
            switch (lineId) {
                case 'line1':
                    content = '<h2>LRT-1</h2>' +
                        '<p>The Light Rail Transit Line 1 (LRT-1) in Metro Manila, inaugurated in 1984 as the first rapid transit line in the Philippines and Southeast Asia, connects the northern and southern parts of the metro, serving millions of commuters. Stretching 20.7 kilometers with 20 stations, LRT-1 links key areas like Baclaran, Pasay, Makati, Manila, and Caloocan, playing a crucial role in reducing traffic congestion and providing affordable transportation.</p>' +
                        '<p>Significantly contributing to the Metro Manila&#39;s public transportation system, LRT-1 has undergone expansions and improvements over the years. Notable nearby establishments include shopping malls, educational institutions, government offices, and cultural sites. The ongoing Cavite extension project aims to further enhance LRT-1&#39;s reach, connecting more communities and addressing the growing population&#39;s transportation needs.</p>' +
                        '<p>Despite challenges such as overcrowding and maintenance issues, discussions on modernization and expansion are in progress. Initiatives focus on improving passenger experience, enhancing safety measures, and implementing technology upgrades for the long-term sustainability and efficiency of LRT-1. It remains a vital component of Metro Manila&#39;s transit system, fostering economic activities and enhancing urban connectivity..</p>';
                    break;
                case 'line2':
                    content = '<h2>LRT-2</h2>' +
                        '<p>From 1976 to 1977, a fourteen-month study funded by the World Bank was conducted by Freeman Fox and Associates, and this suggested a street-level light railway. The then newly created Ministry of Transportation and Communications (MOTC) reviewed and revised the recommendations, introducing an elevated version because of the many intersections. This raised the cost from P1.5 billion to P2 billion. Another foreign firm was commissioned by MOTC for supplementary study which was completed within three months.</p>' +
                        '<p>Additional information about LRT-1...</p>';
                    break;
                case 'line3':
                    content = '<h2>MRT-3</h2>' +
                        '<p>From 1976 to 1977, a fourteen-month study funded by the World Bank was conducted by Freeman Fox and Associates, and this suggested a street-level light railway. The then newly created Ministry of Transportation and Communications (MOTC) reviewed and revised the recommendations, introducing an elevated version because of the many intersections. This raised the cost from P1.5 billion to P2 billion. Another foreign firm was commissioned by MOTC for supplementary study which was completed within three months.</p>' +
                        '<p>Additional information about LRT-1...</p>';
                    break;
                case 'all':
                    content = '<h2>Interconnectivity</h2>' +
                        '<p>From 1976 to 1977, a fourteen-month study funded by the World Bank was conducted by Freeman Fox and Associates, and this suggested a street-level light railway. The then newly created Ministry of Transportation and Communications (MOTC) reviewed and revised the recommendations, introducing an elevated version because of the many intersections. This raised the cost from P1.5 billion to P2 billion. Another foreign firm was commissioned by MOTC for supplementary study which was completed within three months.</p>' +
                        '<p>Additional information about LRT-1...</p>';
                    break;
                default:
                    content = '<h2>Riles MNL</h2><p>Default information...</p>';
            }

            document.querySelector('.text-box').innerHTML = content;
        }

        function toggleLine(lineId) {
            let zoomLevel, centerCoordinates, pitch, buttonColor;

            switch (lineId) {
                case 'line1':
                    zoomLevel = 12.15;
                    centerCoordinates = [120.96509, 14.57425];
                    pitch = 40;
                    buttonColor = 'green';
                    break;
                case 'line2':
                    zoomLevel = 12.21;
                    centerCoordinates = [121.01896, 14.60391];
                    pitch = 40;
                    buttonColor = 'purple';
                    break;
                case 'line3':
                    zoomLevel = 12.12;
                    centerCoordinates = [120.99579, 14.57678];
                    pitch = 40;
                    buttonColor = 'blue';
                    break;
                case 'all':
                    zoomLevel = 12;
                    centerCoordinates = [121.00567, 14.58971];
                    pitch = 40;
                    buttonColor = 'black';
                    break;
                default:
                    zoomLevel = 10.45;
                    centerCoordinates = [120.95607, 14.58194];
                    pitch = 0;
                    buttonColor = '';
            }

            map.flyTo({
                center: centerCoordinates,
                zoom: zoomLevel,
                pitch: pitch,
                essential: true
            });

            map.setLayoutProperty('line1', 'visibility', 'none');
            map.setLayoutProperty('line2', 'visibility', 'none');
            map.setLayoutProperty('line3', 'visibility', 'none');

            map.setLayoutProperty(lineId, 'visibility', 'visible');

            document.querySelectorAll('.btn-line').forEach(function (btn) {
                btn.classList.remove('active');
                btn.style.backgroundColor = '#ccc'; // Reset background color for all buttons
            });

            var activeButton = document.querySelector('.btn-line-' + lineId);
            activeButton.classList.add('active');
            activeButton.style.backgroundColor = buttonColor;
            updateTextBoxContent(lineId);
        }

        function toggleAllLines() {
            var defaultZoom = 11.54;
            var defaultCenter = [120.98155, 14.5891];
            var defaultPitch = 0;

            map.flyTo({
                center: defaultCenter,  // Fixed the typo and added square brackets
                zoom: defaultZoom,
                pitch: defaultPitch,
                essential: true
            });

            map.setLayoutProperty('line1', 'visibility', 'visible');
            map.setLayoutProperty('line2', 'visibility', 'visible');
            map.setLayoutProperty('line3', 'visibility', 'visible');

            document.querySelectorAll('.btn-line').forEach(function (btn) {
                btn.classList.remove('active');
                btn.style.backgroundColor = '#ccc'; // Reset background color for all buttons
            });

            var allLinesButton = document.querySelector('.btn-line-all');
            allLinesButton.classList.add('active');
            allLinesButton.style.backgroundColor = 'black';
            updateTextBoxContent('all');
        }

            document.querySelector('.map-overlay').style.display = 'flex';
            document.querySelector('.text-box').style.display = 'block';
        };

    </script>

</body>

</html>
